#+title: Loop Debugger
#+date: 2023-03-31

Loop logs:
 - [[file:202303291528044-nbody_logs_cstg_kills.txt][Kills]]
 - [[file:202303291528044-nbody_logs_cstg_props.txt][Props]]
 - [[file:202303291528044-nbody_logs_cstg_injects.txt][Injects]]

Termination logs:
 - [[file:202303311301925-nbody_logs_cstg_kills.txt][Kills]]
 - [[file:202303311301925-nbody_logs_cstg_props.txt][Props]]
 - [[file:202303311301925-nbody_logs_cstg_injects.txt][Injects]]

As far as I can tell from the kill log, the system loops when the injection happens on solve.jl:35. (Recorded as solve.jl:10, which is where the function head is—actual argument is on line 35.) This is with ~dtmax~ getting set to NaN.

For reference, here's the error message we get with the terminating version:

#+begin_src
┌ Warning: Automatic dt set the starting dt as NaN, causing instability. Exiting.
└ @ OrdinaryDiffEq ~/.julia/packages/OrdinaryDiffEq/FttEX/src/solve.jl:554
┌ Warning: NaN dt detected. Likely a NaN value in the state, parameters, or derivative value caused this outcome.
└ @ SciMLBase ~/.julia/packages/SciMLBase/o0qGB/src/integrator_interface.jl:512
#+end_src

* First reproduction with logging

Stack trace from loop interruption:

#+begin_src
signal (2): Interrupt: 2
in expression starting at /Users/ashton/Research/FloatTrackerExamples/examples/nbody.jl:43
ijl_binding_resolved_p at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
isdeprecated at ./reflection.jl:106 [inlined]
make_typealias at ./show.jl:541
show_typealias at ./show.jl:721
_show_type at ./show.jl:886
show at ./show.jl:881
jfptr_show_28134 at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/sys.dylib (unknown line)
ijl_apply_generic at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
show_typeparams at ./show.jl:638
show_datatype at ./show.jl:1011
show_datatype at ./show.jl:989 [inlined]
_show_type at ./show.jl:889
show at ./show.jl:881
jfptr_show_28134 at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/sys.dylib (unknown line)
ijl_apply_generic at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
show_typeparams at ./show.jl:638
show_datatype at ./show.jl:1011
show_datatype at ./show.jl:989 [inlined]
_show_type at ./show.jl:889
show at ./show.jl:881
jfptr_show_28134 at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/sys.dylib (unknown line)
ijl_apply_generic at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
show_typeparams at ./show.jl:638
show_datatype at ./show.jl:1011
show_datatype at ./show.jl:989 [inlined]
_show_type at ./show.jl:889
show at ./show.jl:881
jfptr_show_28134 at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/sys.dylib (unknown line)
ijl_apply_generic at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
#sprint#452 at ./strings/io.jl:112
sprint##kw at ./strings/io.jl:107 [inlined]
#print_type_stacktrace#511 at ./show.jl:2402 [inlined]
print_type_stacktrace at ./show.jl:2401
jfptr_print_type_stacktrace_39983 at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/sys.dylib (unknown line)
ijl_apply_generic at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
#show_tuple_as_call#510 at ./show.jl:2383
show_tuple_as_call##kw at ./show.jl:2352 [inlined]
show_spec_linfo at ./stacktraces.jl:244
show at ./stacktraces.jl:255
print at ./strings/io.jl:35
unknown function (ip: 0x2979f40c3)
ijl_apply_generic at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
print_to_string at ./strings/io.jl:144
string at ./strings/io.jl:185 [inlined]
#7 at ./none:0 [inlined]
iterate at ./generator.jl:47 [inlined]
collect_to! at ./array.jl:845 [inlined]
collect_to_with_first! at ./array.jl:823 [inlined]
collect at ./array.jl:797
to_string at /Users/ashton/.julia/dev/FloatTracker/src/Event.jl:59
#10 at /Users/ashton/.julia/dev/FloatTracker/src/Logger.jl:59
#open#378 at ./io.jl:384
open at ./io.jl:381 [inlined]
write_log_to_file at /Users/ashton/.julia/dev/FloatTracker/src/Logger.jl:57
write_out_logs at /Users/ashton/.julia/dev/FloatTracker/src/Logger.jl:43
log_event at /Users/ashton/.julia/dev/FloatTracker/src/Logger.jl:37
check_error at /Users/ashton/.julia/dev/FloatTracker/src/TrackedFloat.jl:19 [inlined]
< at /Users/ashton/.julia/dev/FloatTracker/src/TrackedFloat.jl:180
> at ./operators.jl:382 [inlined]
handle_tstop! at /Users/ashton/.julia/packages/OrdinaryDiffEq/FttEX/src/integrators/integrator_utils.jl:429
solve! at /Users/ashton/.julia/packages/OrdinaryDiffEq/FttEX/src/solve.jl:526
#__solve#627 at /Users/ashton/.julia/packages/OrdinaryDiffEq/FttEX/src/solve.jl:6 [inlined]
__solve at /Users/ashton/.julia/packages/OrdinaryDiffEq/FttEX/src/solve.jl:1 [inlined]
#solve_call#22 at /Users/ashton/.julia/packages/DiffEqBase/qPmC2/src/solve.jl:509 [inlined]
solve_call at /Users/ashton/.julia/packages/DiffEqBase/qPmC2/src/solve.jl:479 [inlined]
#solve_up#29 at /Users/ashton/.julia/packages/DiffEqBase/qPmC2/src/solve.jl:932 [inlined]
solve_up at /Users/ashton/.julia/packages/DiffEqBase/qPmC2/src/solve.jl:905 [inlined]
#solve#27 at /Users/ashton/.julia/packages/DiffEqBase/qPmC2/src/solve.jl:842 [inlined]
solve at /Users/ashton/.julia/packages/DiffEqBase/qPmC2/src/solve.jl:832
unknown function (ip: 0x16fd30387)
ijl_apply_generic at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
#calculate_simulation#58 at /Users/ashton/.julia/packages/NBodySimulator/8dVZd/src/nbody_simulation_result.jl:304
calculate_simulation at /Users/ashton/.julia/packages/NBodySimulator/8dVZd/src/nbody_simulation_result.jl:303 [inlined]
calculate_simulation at /Users/ashton/.julia/packages/NBodySimulator/8dVZd/src/nbody_simulation_result.jl:303 [inlined]
#run_simulation#57 at /Users/ashton/.julia/packages/NBodySimulator/8dVZd/src/nbody_simulation_result.jl:299 [inlined]
run_simulation at /Users/ashton/.julia/packages/NBodySimulator/8dVZd/src/nbody_simulation_result.jl:295
unknown function (ip: 0x120cf40ef)
ijl_apply_generic at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
do_call at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
eval_body at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
jl_interpret_toplevel_thunk at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
jl_toplevel_eval_flex at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
jl_toplevel_eval_flex at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
ijl_toplevel_eval_in at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
eval at ./boot.jl:368 [inlined]
include_string at ./loading.jl:1428
ijl_apply_generic at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
_include at ./loading.jl:1488
include at ./Base.jl:419
jfptr_include_55924 at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/sys.dylib (unknown line)
ijl_apply_generic at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
exec_options at ./client.jl:303
_start at ./client.jl:522
jfptr__start_59061 at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/sys.dylib (unknown line)
ijl_apply_generic at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
true_main at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
jl_repl_entrypoint at /Users/ashton/.asdf/installs/julia/1.8.5/lib/julia/libjulia-internal.1.8.dylib (unknown line)
unknown function (ip: 0x0)
Allocations: 95423324 (Pool: 94889068; Big: 534256); GC: 89
#+end_src

 - [[file:202304061343986-nbody_logs_error_log.txt][Errors]]
 - [[file:202304061343986-nbody_logs_cstg_kills.txt][Kills]]
 - [[file:202304061343986-nbody_logs_cstg_props.txt][Props]]
 - [[file:202304061343986-nbody_logs_cstg_injects.txt][Injects]]

Recording file:

#+begin_src
2, solve.jl
#+end_src
